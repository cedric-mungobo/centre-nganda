import{r as v,T as $,o as B,a as d,c as m,b as o,u as s,w as b,F as E,Z as R,d as e,j as _,e as a,l as j,g as h,v as k,t as V,k as y,h as D,m as P,n as A}from"./app-CEV2x9EZ.js";import{_ as N}from"./AuthenticatedLayout-Dt5cXc8p.js";import{_ as p,a as C,b as g}from"./InputError-DLk3xGwY.js";import{P as q}from"./PrimaryButton-DSoqJejX.js";import{_ as F}from"./PrimeEditor-D7thWifq.js";/* empty css            */import"./ApplicationLogo-DiPWE1NX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"flex justify-between items-center"},Z={class:"flex space-x-2"},G={class:"py-12"},J={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6 text-gray-900"},W={class:"mt-2 text-xs"},X={class:"mt-2 p-2 bg-gray-100 rounded overflow-auto max-h-40"},Y={class:"mt-2 flex space-x-2"},ee={key:0,class:"mt-2"},te={key:1,class:"mt-4"},le={class:"mt-1 flex items-center"},se={key:0,class:"relative inline-block h-32 w-32 overflow-hidden rounded-md"},oe=["src"],ie={key:1,class:"inline-block h-32 w-32 overflow-hidden rounded-md bg-gray-100"},ne={class:"flex space-x-6"},ae={key:0},re={class:"flex items-end"},ue={class:"flex h-6 items-center"},de={class:"flex items-center justify-end mt-4"},he={__name:"Edit",props:{post:Object},setup(w){const i=w,r=v(i.post.content||"<div><br></div>"),u=v(!0),c=v(i.post.content||""),l=$({title:i.post.title,excerpt:i.post.excerpt||"",content:i.post.content||"",featured_image:null,status:i.post.status,featured:i.post.featured,published_at:i.post.published_at?new Date(i.post.published_at).toISOString().slice(0,16):null,_method:"PUT"}),x=v(i.post.featured_image?`/storage/${i.post.featured_image}`:null),U=v(null);B(()=>{console.log("Contenu initial de l'éditeur:",r.value)});const M=()=>{u.value=!u.value,u.value?c.value=r.value||i.post.content||"":(r.value=c.value,l.content=c.value)},L=f=>{const t=f.target.files[0];if(l.featured_image=t,t){const n=new FileReader;n.onload=I=>{x.value=I.target.result},n.readAsDataURL(t)}},z=()=>{l.featured_image=null,x.value=null},T=()=>{!r.value&&i.post.content&&(r.value=i.post.content,l.content=i.post.content,console.log("Contenu initialisé manuellement:",r.value))},S=()=>{u.value?l.content=c.value:l.content=r.value||i.post.content||"",l.post(route("admin.posts.update",i.post.id),{onSuccess:()=>{l.featured_image=null}})},H=()=>{if(l.status==="published"&&!l.published_at){const f=new Date;l.published_at=f.toISOString().slice(0,16)}};return(f,t)=>(d(),m(E,null,[o(s(R),{title:"Modifier l'article"}),o(N,null,{header:b(()=>[e("div",O,[t[11]||(t[11]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Modifier l'article",-1)),e("div",Z,[o(s(_),{href:`/blog/${w.post.slug}`,target:"_blank",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors"},{default:b(()=>t[9]||(t[9]=[a(" Voir l'article ")])),_:1},8,["href"]),o(s(_),{href:f.route("admin.posts.index"),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors"},{default:b(()=>t[10]||(t[10]=[a(" Retour à la liste ")])),_:1},8,["href"])])])]),default:b(()=>[e("div",G,[e("div",J,[e("div",K,[e("div",Q,[e("form",{onSubmit:j(S,["prevent"]),class:"space-y-6"},[e("div",null,[o(p,{for:"title",value:"Titre"}),o(C,{id:"title",type:"text",class:"mt-1 block w-full",modelValue:s(l).title,"onUpdate:modelValue":t[0]||(t[0]=n=>s(l).title=n),required:"",autofocus:""},null,8,["modelValue"]),o(g,{class:"mt-2",message:s(l).errors.title},null,8,["message"])]),e("div",null,[o(p,{for:"excerpt",value:"Extrait (optionnel)"}),h(e("textarea",{id:"excerpt",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm","onUpdate:modelValue":t[1]||(t[1]=n=>s(l).excerpt=n),rows:"3"},null,512),[[k,s(l).excerpt]]),o(g,{class:"mt-2",message:s(l).errors.excerpt},null,8,["message"])]),e("div",null,[o(p,{for:"content",value:"Contenu"}),o(F,{modelValue:r.value,"onUpdate:modelValue":[t[2]||(t[2]=n=>r.value=n),t[3]||(t[3]=n=>s(l).content=n)],class:"mt-1"},null,8,["modelValue"]),e("details",W,[t[12]||(t[12]=e("summary",{class:"text-gray-500 cursor-pointer"},"Voir le HTML brut",-1)),e("pre",X,V(i.post.content),1)]),e("div",Y,[!r.value&&i.post.content?(d(),m("button",{key:0,type:"button",onClick:T,class:"px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"}," Initialiser l'éditeur manuellement ")):y("",!0),e("button",{type:"button",onClick:M,class:"px-3 py-2 text-sm font-medium bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors"},V(u.value?"Essayer l'éditeur visuel":"Revenir à l'éditeur HTML"),1)]),u.value?y("",!0):(d(),m("div",ee,t[13]||(t[13]=[e("p",{class:"text-sm text-amber-600"},` ⚠️ L'éditeur visuel peut ne pas afficher correctement le contenu. Si vous ne voyez pas votre contenu, cliquez sur "Revenir à l'éditeur HTML" pour éditer le code HTML directement. `,-1)]))),u.value?(d(),m("div",te,[o(p,{value:"Édition HTML directe"}),h(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=n=>c.value=n),class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm font-mono",rows:"15",spellcheck:"false"},null,512),[[k,c.value]]),t[14]||(t[14]=e("div",{class:"mt-2 text-sm text-gray-600 space-y-2"},[e("p",null,[e("strong",null,"Conseils pour l'édition HTML :")]),e("ul",{class:"list-disc pl-5 space-y-1"},[e("li",null,[a("Utilisez "),e("code",null,"<p>...</p>"),a(" pour les paragraphes")]),e("li",null,[a("Utilisez "),e("code",null,"<h1>...</h1>"),a(" à "),e("code",null,"<h6>...</h6>"),a(" pour les titres")]),e("li",null,[a("Utilisez "),e("code",null,"<strong>...</strong>"),a(" pour le texte en gras")]),e("li",null,[a("Utilisez "),e("code",null,"<em>...</em>"),a(" pour le texte en italique")]),e("li",null,[a("Utilisez "),e("code",null,'<a href="URL">...</a>'),a(" pour les liens")]),e("li",null,[a("Utilisez "),e("code",null,'<img src="URL" alt="texte alternatif">'),a(" pour les images")])])],-1))])):y("",!0),o(g,{class:"mt-2",message:s(l).errors.content},null,8,["message"])]),e("div",null,[o(p,{for:"featured_image",value:"Image à la une (optionnel)"}),e("div",le,[x.value?(d(),m("span",se,[e("img",{src:x.value,class:"h-full w-full object-cover"},null,8,oe),e("button",{type:"button",onClick:z,class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 shadow-sm"},t[15]||(t[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])):(d(),m("span",ie,t[16]||(t[16]=[e("svg",{class:"h-full w-full text-gray-300",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})],-1)]))),e("button",{type:"button",class:"ml-5 rounded-md border border-gray-300 bg-white py-2 px-3 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:t[5]||(t[5]=n=>f.$refs.fileInput.click())}," Changer "),e("input",{ref_key:"fileInput",ref:U,type:"file",class:"hidden",onChange:L,accept:"image/*"},null,544)]),o(g,{class:"mt-2",message:s(l).errors.featured_image},null,8,["message"])]),e("div",ne,[e("div",null,[o(p,{for:"status",value:"Statut"}),h(e("select",{id:"status","onUpdate:modelValue":t[6]||(t[6]=n=>s(l).status=n),onChange:H,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},t[17]||(t[17]=[e("option",{value:"draft"},"Brouillon",-1),e("option",{value:"published"},"Publié",-1)]),544),[[D,s(l).status]]),o(g,{class:"mt-2",message:s(l).errors.status},null,8,["message"])]),s(l).status==="published"?(d(),m("div",ae,[o(p,{for:"published_at",value:"Date de publication"}),o(C,{id:"published_at",type:"datetime-local",class:"mt-1 block w-full",modelValue:s(l).published_at,"onUpdate:modelValue":t[7]||(t[7]=n=>s(l).published_at=n)},null,8,["modelValue"]),o(g,{class:"mt-2",message:s(l).errors.published_at},null,8,["message"])])):y("",!0),e("div",re,[e("div",ue,[h(e("input",{id:"featured",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=n=>s(l).featured=n),class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[P,s(l).featured]])]),t[18]||(t[18]=e("div",{class:"ml-3 text-sm"},[e("label",{for:"featured",class:"font-medium text-gray-700"},"Article à la une")],-1))])]),e("div",de,[o(q,{class:A(["ml-4",{"opacity-25":s(l).processing}]),disabled:s(l).processing},{default:b(()=>t[19]||(t[19]=[a(" Mettre à jour l'article ")])),_:1},8,["class","disabled"])])],32)])])])])]),_:1})],64))}};export{he as default};
